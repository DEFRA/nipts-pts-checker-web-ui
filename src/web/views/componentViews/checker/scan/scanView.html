{% extends "./layouts/checkerLayout.html" %}

{% block headContent %}
<script src="/web/assets/javascripts/html5-qrcode.min.js"></script>
<style>
    #qr-reader {
        width: 90vw !important;
        max-width: 600px !important;
        height: 90vw !important;
        max-height: 600px !important;
        margin: 0 auto;
        position: relative;
        box-sizing: border-box;
    }

    #qr-reader video {
        width: 100% !important;
        height: 100% !important;
        object-fit: cover;
    }

    #qr-reader canvas {
        width: 100% !important;
        height: 100% !important;
    }

    #qr-shaded-region {
        width: 100% !important;
        height: 100% !important;
    }

    #qr-reader__dashboard_section_csr {
        text-align: center;
        width: 100% !important;
        height: 100% !important;
        position: relative !important;
    }

    #qr-reader__dashboard_section_csr button {
        margin: 10px;
    }

    .camera-access-prompt {
        text-align: left;
        margin-top: 20px;
    }

    .camera-access-denied {
        color: red;
        margin-top: 20px;
    }

    .flash-button {
        margin: 20px auto 0;
        width: 90vw !important;
        max-width: 600px !important;
        text-align: right;
        display: none;
    }

    .flash-button button {
        width: 140px;
        margin-bottom: 10px;
    }

    .govuk-button--flash {
        background-color: #00703c;
        color: white;
    }

    #qr-reader__dashboard_section_swaplink {
        display: none !important;
    }

    #qr-reader__scan_region {
        width: 100% !important;
        height: 100% !important;
        min-height: 100% !important;
        position: relative !important;
    }

    #qr-reader__scan_region video {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
    }

    .govuk-loader {
        display: none;
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        background-color: rgba(255, 255, 255, .85);
        z-index: 9999;
    }

    .govuk-loader__container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
    }

    .govuk-loader__spinner {
        border: 4px solid #b1b4b6;
        border-top: 4px solid #00703c;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        display: inline-block;
        margin-bottom: 15px;
    }

    .govuk-loader__text {
        color: #0b0c0c;
        font-family: "GDS Transport", arial, sans-serif;
        -webkit-font-smoothing: antialiased;
        font-weight: 400;
        font-size: 19px;
        line-height: 1.31579;
        margin-top: 15px;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .is-loading .govuk-loader {
        display: block;
    }

    @media (max-width: 480px) {
        #qr-reader {
            width: 95vw !important;
            height: 95vw !important;
        }

        .flash-button {
            width: 95vw !important;
        }
    }

    @media (min-width: 481px) and (max-width: 768px) {
        #qr-reader {
            width: 90vw !important;
            height: 90vw !important;
        }
    }

    @media (min-width: 769px) {
        #qr-reader {
            width: 600px !important;
            height: 600px !important;
        }

        .flash-button {
            width: 600px !important;
        }
    }
</style>
{% endblock %}

{% block pageTitle %}Scan QR Code - {{currentSailingSlot.pageTitle}} â€“ GOV.UK{% endblock %}

{% block content %}
<div class="govuk-grid-row govuk-!-margin-bottom-2 govuk-!-margin-top-4">
    <div class="govuk-grid-column-two-thirds govuk-!-margin-top-0">
        <h1 class="govuk-heading-xl govuk-!-margin-bottom-0">
            Scan a QR code
        </h1>
    </div>
</div>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <div id="camera-access-prompt" class="camera-access-prompt">
            <p class="govuk-body">You need to allow camera access to scan.</p>
            <button id="allow-camera-access" class="govuk-button" data-module="govuk-button">
                Allow camera access
            </button>
        </div>
        <div id="camera-access-denied" class="camera-access-denied" style="display: none;">
            <p class="govuk-body">Camera access is blocked. Please allow camera access to scan QR codes.</p>
        </div>
        <div class="flash-button">
            <button id="toggle-flash" class="govuk-button govuk-button--flash" data-module="govuk-button">
                Turn flash on
            </button>
        </div>
        <div id="qr-reader" style="display: none;"></div>
        <div id="qr-reader-results"></div>
    </div>
</div>
{% endblock %}

{% block bodyEnd %}
<script src="/web/assets/javascripts/scan.js"></script>
{% endblock %}